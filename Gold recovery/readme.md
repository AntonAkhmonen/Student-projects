# Данные
В наличии есть следующие данные связанные с технологическим процессом извлечением золота из руды:
1. Описание этапов технологического процесса
- Флотация. Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов. На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости)
- Очистка. Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.

2. Описание параметров технологического процесса
- Rougher feed — исходное сырье
- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
- Xanthate ** - ксантогенат (промотер, или активатор флотации);
- Sulphate — сульфат (на данном производстве сульфид натрия);
- Depressant — депрессант (силикат натрия).
- Rougher process (англ. «грубый процесс») — флотация
- Rougher tails — отвальные хвосты
- Float banks — флотационная установка
- Cleaner process — очистка
- Rougher Au — черновой концентрат золота
- Final Au — финальный концентрат золота

3. Описание параметров этапов технологического процесса
- air amount — объём воздуха
- fluid levels — уровень жидкости
- feed size — размер гранул сырья
- feed rate — скорость подачи

4. Наименование признаков
Наименование признаков должно быть такое:
[этап].[тип_параметра].[название_параметра]
Пример: rougher.input.feed_ag
Возможные значения для блока [этап]:
- rougher — флотация
- primary_cleaner — первичная очистка
- secondary_cleaner — вторичная очистка
- final — финальные характеристики
Возможные значения для блока [тип_параметра]:
- input — параметры сырья
- output — параметры продукта
- state — параметры, характеризующие текущее состояние этапа
- calculation — расчётные характеристики


# Задача
Необходимо смоделировать процесс восстановления золота из руды. Эффективность обогащения рассчитывается по формуле:
Recovery = С*(F-T)/(F*(C-T)), где:
- C — доля золота в концентрате после флотации/очистки
- F — доля золота в сырье/концентрате до флотации/очистки
- T — доля золота в отвальных хвостах после флотации/очистки
Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.
Для решения задачи введём новую метрику качества — sMAPE (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).
![image](https://user-images.githubusercontent.com/121233047/210042306-ce0058c8-5c5f-485a-8143-2e43005aaa23.png)

![image](https://user-images.githubusercontent.com/121233047/210042380-f4952ce9-13f7-4b01-b0d0-ce7d7db84bf7.png) Значение целевого признака для объекта с порядковым номером i в выборке, на которой измеряется качество

![image](https://user-images.githubusercontent.com/121233047/210042479-2c78b6a3-8d2a-4ec2-a962-8fe0da9c1835.png)
Значение предсказания для объекта с порядковым номером i, например, в тестовой выборке

![image](https://user-images.githubusercontent.com/121233047/210042531-0888a7b5-3c17-4cb9-bdd4-548f7a4351c5.png)
Количество объектов в выборке

![image](https://user-images.githubusercontent.com/121233047/210042713-dc3fbeb8-7af3-48bf-b98c-4554c877ea29.png)
Суммирование по всем объектам выборки (i меняется от 1 до N)

Нужно спрогнозировать сразу две величины:
- эффективность обогащения чернового концентрата rougher.output.recovery;
- эффективность обогащения финального концентрата final.output.recovery.
Итоговая метрика складывается из двух величин:
![image](https://user-images.githubusercontent.com/121233047/210042782-fbffd62b-6cb3-46d4-bf67-0d0d4a61e796.png)


# Используемые библиотеки
pandas, sklearn, scipy, numpy

# Результаты
Сравнение различных моделей предсказания показало что максимальную точность прогнозирования дает линейная регрессия. Проект завершен
